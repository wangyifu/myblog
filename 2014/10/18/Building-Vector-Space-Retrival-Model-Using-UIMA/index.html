<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Building Vector Space Retrival Model Using UIMA | Yifu&#39;s tech blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="# Task 2This is the origin result of task 1. Our goal is to improve MRR as much as we can.">
<meta property="og:type" content="article">
<meta property="og:title" content="Building Vector Space Retrival Model Using UIMA">
<meta property="og:url" content="http://wangyifu.github.io/myblog/myblog/2014/10/18/Building-Vector-Space-Retrival-Model-Using-UIMA/">
<meta property="og:site_name" content="Yifu's tech blog">
<meta property="og:description" content="# Task 2This is the origin result of task 1. Our goal is to improve MRR as much as we can.">
<meta property="og:image" content="/myblog/images/2014/Oct/origin_result.png">
<meta property="og:image" content="/myblog/images/2014/Oct/updated_tokenize.png">
<meta property="og:image" content="/myblog/images/2014/Oct/updated_stemming.png">
<meta property="og:image" content="/myblog/images/2014/Oct/dice_coefficient.png">
<meta property="og:image" content="/myblog/images/2014/Oct/dice_coefficient_result.png">
<meta property="og:image" content="/myblog/images/2014/Oct/jaccord_result.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Building Vector Space Retrival Model Using UIMA">
<meta name="twitter:description" content="# Task 2This is the origin result of task 1. Our goal is to improve MRR as much as we can.">

  
    <link rel="alternative" href="/atom.xml" title="Yifu&#39;s tech blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/myblog/css/style.css" type="text/css">

  

  <script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<div class="profilepic">
			<img src="https://avatars2.githubusercontent.com/u/1173901?v=3&amp;u=a835cd023bbecfa97f100aac5c08387a4bbc65ed&amp;s=140">
		</div>

		<hgroup>
		  <h1 class="header-author"><a href="/">Yifu Wang</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/myblog/">homepage</a></li>
				        
							<li><a href="/myblog/archives">archives</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/wangyifu" title="github">github</a>
					        
								<a class="linkedin" target="_blank" href="https://github.com/wangyifu" title="linkedin">linkedin</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud">
						<a href="/myblog/tags/Java/" style="font-size: 10.00px;">Java</a><a href="/myblog/tags/Markdown/" style="font-size: 10.00px;">Markdown</a><a href="/myblog/tags/UIMA/" style="font-size: 10.00px;">UIMA</a><a href="/myblog/tags/algorithm/" style="font-size: 10.00px;">algorithm</a><a href="/myblog/tags/leetcode/" style="font-size: 20.00px;">leetcode</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					Work hard, dream big.
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay"></div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="https://avatars2.githubusercontent.com/u/1173901?v=3&amp;u=a835cd023bbecfa97f100aac5c08387a4bbc65ed&amp;s=140">
			</div>

			<hgroup>
			  <h1 class="header-author"><a href="/">Yifu Wang</a></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/myblog/">homepage</a></li>
		        
					<li><a href="/myblog/archives">archives</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/wangyifu" title="github">github</a>
			        
						<a class="linkedin" target="_blank" href="https://github.com/wangyifu" title="linkedin">linkedin</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <article id="post-Building-Vector-Space-Retrival-Model-Using-UIMA" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/myblog/2014/10/18/Building-Vector-Space-Retrival-Model-Using-UIMA/" class="article-date">
  	<time datetime="2014-10-18T19:25:44.000Z" itemprop="datePublished">Oct 18 2014</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/myblog/categories/learning/">learning</a>
  </div>

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/myblog/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/myblog/tags/UIMA/">UIMA</a></li></ul>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Building Vector Space Retrival Model Using UIMA
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <a id="more"></a><br># Task 2<br><br>This is the origin result of task 1. Our goal is to improve MRR as much as we can.<br><br><img src="/myblog/images/2014/Oct/origin_result.png"><br><br><a id="more"></a>

<h2 id="Step_1-_Optimalizing_Tokenize_Algorithm">Step 1. Optimalizing Tokenize Algorithm</h2>
<p>The origin tokenize algorithm just split sentence by spaces. This method will get some wrong results like below:</p>
<blockquote>
<p>world.<br>“Mendocino<br>Tree”<br>Lake?<br>Bernardino,<br>…</p>
</blockquote>
<p>In this case, the word “world.” in answer text will not match word “world” in query text. But actually they should be considerd as same.</p>
<p>I updated this tokenize algorithm to reduce mismatch. Firstly, the sentence is converted to lower case and trimed. Then, I split words by many seperators rather than just blank using regular expression, which includes:</p>
<blockquote>
<p>! ? , . “ ; () [] {} &lt;&gt;   </p>
</blockquote>
<figure class="highlight java"><figcaption><span>Optimaized Tokenize Function</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">List&lt;String&gt; tokenize1(String doc) {</div><div class="line">  List&lt;String&gt; res = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">  <span class="comment">//changing every word to lowercase to avoid mismatch</span></div><div class="line">  doc = doc.toLowerCase().trim();</div><div class="line">  String patternStr = <span class="string">"[\\s\\;\\(\\)\\[\\]\\{\\}\\&lt;\\&gt;\".,?!]+"</span>;</div><div class="line">  <span class="keyword">for</span> (String s: doc.split(patternStr)){</div><div class="line">    res.add(s);</div><div class="line">    System.out.println(s);</div><div class="line">  }</div><div class="line">  <span class="keyword">return</span> res;</div><div class="line">}</div></pre></td></tr></table></figure>

<p>Note there are still some exceptions:</p>
<ul>
<li>Comma: inside numbers like <strong>3,000,000</strong></li>
<li>Period: Not for abbreviations: <strong>O.K.</strong> Not for URLs: <strong>www.google.com</strong></li>
<li>Slash: Not for fractions: <strong>1/2</strong>. Not for URLS: <strong>www.google.com/search</strong></li>
<li>…</li>
</ul>
<p>It is hard using regular expression to exclude all these exceptions. But by applying this method, the MMR score already has a signifiant improvment from 0.43 to 0.58. So I believe this approach maybe is good enough for this part. If we want our tokenize algorithm more precisely, we may need a dictionary of words, and some data structures like prefix tree and Trie.</p>
<img src="/myblog/images/2014/Oct/updated_tokenize.png">

<h2 id="Better_Stemming_Algorithm">Better Stemming Algorithm</h2>
<p>In last part, we optimaized tokenize algorithm by applying multiple seperaters. However, there is still a problem: Our model can not distinguish different forms of same word. For example, it will treat <strong>“is”</strong>, <strong>“was”</strong> as different words. But actually these two words play the same role in sentence.</p>
<p>We can use provided Stanford lemmatizer to solve this. Just call the <strong>stemWord(str)</strong> function before we add tokens to list.</p>
<p>Here are some converted words:</p>
<blockquote>
<p>named, name<br>leading, lead<br>is, be<br>feet, foot<br>mcdonald’s,mcdonald’<br>…</p>
</blockquote>
<p>Last one seems not like a good conversion, so I modified a little to change <strong>“mcdonald’s”</strong> to <strong>“mcdonald”</strong>. This method improves MMR score from 0.58 to 0.70. Again, a remarkable progress.</p>
<img src="/myblog/images/2014/Oct/updated_stemming.png">


<h2 id="Apply_Some_Different_Similarity_Measurement">Apply Some Different Similarity Measurement</h2>
<p>I did not know there are so many ways to <a href="http://en.wikipedia.org/wiki/String_metric" target="_blank" rel="external">evaluate string similarity</a> until this project.</p>
<h4 id="Hamming_distance:"><strong>Hamming distance</strong>:</h4>
<p>“ka<strong>rol</strong>in” and “ka<strong>thr</strong>in” is 3.</p>
<h4 id="Levenshtein_distance_and_Damerau–Levenshtein_distance:"><strong>Levenshtein distance and Damerau–Levenshtein distance</strong>:</h4>
<ol>
<li>“<strong>k</strong>itten” →  “<strong>s</strong>itten” (substitution of “s” for “k”) </li>
<li>“sittin” →  “sittin<strong>g</strong>“ (insertion of “g” at the end).  </li>
</ol>
<h4 id="Soundex_Distance_Metric:"><strong>Soundex Distance Metric</strong>:</h4>
<p>   Mapping char to similar value if it sound alike: “Robert” and “Rupert” return the same string “R163” while “Rubin” yields “R150”.  </p>
<h4 id="Jaccord_Coefficient:"><strong>Jaccord Coefficient</strong>:</h4>
<p>   <a href="http://www.gees.ac.uk/resources/hosted/fieldsim/con_jaccard.htm" target="_blank" rel="external">link</a></p>
<h4 id="Dice’s_coefficient:"><strong>Dice’s coefficient</strong>:</h4>
<p>   For two word <code>night</code>, <code>nacht</code>:<br>   We would find the set of bigrams in each word:<br>   {<code>ni</code>,<code>ih</code>,<code>gh</code>,<code>ht</code>}<br>   {<code>na</code>,<code>ac</code>,<code>ch</code>,<code>ht</code>}<br>   Each set has four elements, and the intersection of these two sets has only one element: <code>ht</code>.<br>   Inserting these numbers into the formula. s = (2 · 1) / (4 + 4) = 0.25.  </p>
<img src="/myblog/images/2014/Oct/dice_coefficient.png">

<p>I firstly chose dice coefficient algorithm to calculate string similarity. However, from the result below, we can see that the MRR score reduces from 0.70 to 0.61. I had double checked the whole function, found nothing wrong. The probably reason is that optimized tokenlize algorithm and stemming algorithm helps cosine similiarly performs better than dice coefficient. So dice coefficient has nothing to do with last two steps’ optimization. This algorithm has a better performance than original cosine similiarly algorithm (MMR from 0.43 to 0.61). </p>
<p>As the result, although cosine similiarity algorithm is somehow naive, it does not break the structure of token, which means it has a potential to optimize. Like using Stanford Lemmatizer to put differnet forms of same word into one category. However, if we using dice coefficient, although it breaks word into a smaller “grain size”, it also loses information of words, thus we can not optimize the performance from the meaning of words. So if we just want to compare two documents’ similarity, we may want to choose dice coefficient. But if we want to learn more from the meaning of sentence, we should keep the structure of tokens.</p>
<img src="/myblog/images/2014/Oct/dice_coefficient_result.png">

<p>Then, I usd Jaccord similarity. This method is easy to implement, just change a little from cosine similarity. We get pretty results from this method, MRR jumps from 0.70 to 0.82(see figure below). It is probably because this method is more precisely than cosine similarity, and it can benefit from other steps’ optimaztion, since it not break the structure of tokens.</p>
<img src="/myblog/images/2014/Oct/jaccord_result.png">

      
    </div>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/myblog/2014/10/27/Leetcode-Pow-X-n/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          Leetcode: Pow(X,n)
        
      </div>
    </a>
  
  
    <a href="/myblog/2014/10/18/Learning-Markdown/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Learning Markdown</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到：</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>





<section id="comments">
  <div id="disqus_thread"></div>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'yifustechblog'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 Yifu Wang
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/myblog/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/myblog/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>

  <script src="/myblog/js/main.js" type="text/javascript"></script>


  </div>
</body>
</html>